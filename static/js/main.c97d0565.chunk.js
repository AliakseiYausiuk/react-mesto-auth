(this["webpackJsonpmesto-react"]=this["webpackJsonpmesto-react"]||[]).push([[0],{29:function(e,t,n){},37:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),o=n(18),s=n.n(o),i=(n(29),n(22)),r=n(2),u=n(3),l=n.p+"static/media/logo.6129e9de.svg",d=n(8),p=n(0);function j(e){var t=e.loggedIn,n=e.email,a=e.handleSignOut,c=Object(u.h)().pathname,o="".concat("/sign-in"===c?"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f":"\u0412\u043e\u0439\u0442\u0438"),s="".concat("/sign-in"===c?"/sign-up":"/sign-in");return Object(p.jsxs)("header",{className:"header",children:[Object(p.jsx)("img",{className:"logo",src:l,alt:"\u041b\u043e\u0433\u043e\u0442\u0438\u043f"}),Object(p.jsx)("div",{className:"header__login",children:t?Object(p.jsxs)(p.Fragment,{children:[Object(p.jsx)("p",{className:"header__email",children:n}),Object(p.jsx)(d.b,{className:"header__signout",to:"",onClick:a,children:"\u0412\u044b\u0439\u0442\u0438"})]}):Object(p.jsx)(d.b,{to:s,className:"header__link",children:o})})]})}var h=n.p+"static/media/Vector.f0dd9c51.svg",b=n.p+"static/media/plus.d5d6f8af.svg",m=c.a.createContext(),f=function(e){var t=e.card,n=e.onCardClick,c=e.onCardLike,o=e.onCardDelete,s=Object(a.useContext)(m);var i=t.owner._id===s._id,r=i?"cards__btn-delete":"",u=t.likes.some((function(e){return e._id===s._id}))?"cards__like cards__like_active":"cards__like";return Object(p.jsxs)("li",{id:t._id,className:"cards__card",children:[i&&Object(p.jsx)("button",{className:r,type:"button","aria-label":"btn-delete",onClick:function(){return function(e){o(e)}(t)}}),Object(p.jsxs)("figure",{className:"cards__list",children:[Object(p.jsx)("img",{className:"cards__foto",src:t.link,alt:t.name,onClick:function(){return function(e){n(e)}(t)}}),Object(p.jsx)("figcaption",{className:"cards__text",children:t.name}),Object(p.jsxs)("ul",{className:"cards__item",children:[Object(p.jsx)("li",{children:Object(p.jsx)("button",{className:u,type:"button","aria-label":"btn-like",onClick:function(){return function(e){c(e)}(t)}})}),Object(p.jsx)("li",{children:Object(p.jsx)("span",{className:"cards__like-number",children:t.likes.length})})]})]})]})},O=function(e){var t=e.cards,n=e.onCardLike,c=e.onCardDelete,o=e.onEditAvatar,s=e.onEditProfile,i=e.onAddPlace,r=e.onCardClick,u=Object(a.useContext)(m);return Object(p.jsxs)("main",{className:"main",children:[Object(p.jsxs)("section",{className:"profile",children:[Object(p.jsx)("div",{className:"profile__avatar-hover",children:Object(p.jsx)("img",{className:"profile__avatar",src:u?u.avatar:"",alt:"\u0410\u0432\u0430\u0442\u0430\u0440",onClick:o})}),Object(p.jsxs)("div",{className:"profile__list",children:[Object(p.jsx)("h1",{className:"profile__info",children:u?u.name:"\u0416\u0430\u043a-\u0418\u0432 \u041a\u0443\u0441\u0442\u043e"}),Object(p.jsx)("div",{children:Object(p.jsx)("button",{className:"profile__edit-button",type:"button","aria-label":"btn-edit",onClick:s,children:Object(p.jsx)("img",{src:h,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u0440\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c"})})}),Object(p.jsx)("div",{children:Object(p.jsx)("p",{className:"profile__text",children:u?u.about:"\u0418\u0441\u0441\u043b\u0435\u0434\u043e\u0432\u0430\u0442\u0435\u043b\u044c \u043e\u043a\u0435\u0430\u043d\u0430"})})]}),Object(p.jsx)("button",{className:"profile__add-Button",type:"button","aria-label":"btn-add",onClick:i,children:Object(p.jsx)("img",{className:"profile__add-Btn-img",src:b,alt:"\u041a\u043d\u043e\u043f\u043a\u0430 \u043f\u043b\u044e\u0441"})})]}),Object(p.jsx)("section",{className:"elements",children:Object(p.jsx)("ul",{className:"cards",children:t.map((function(e){return Object(p.jsx)(f,{card:e,onCardClick:r,onCardLike:n,onCardDelete:c},e._id)}))})})]})},_=function(){return Object(p.jsx)("footer",{className:"footer",children:Object(p.jsx)("p",{className:"footer__text",children:"\xa9 2021 Mesto Russia"})})},g=function(e){var t=e.card,n=e.onClose;return Object(p.jsx)("div",{id:"pop-up-foto",className:t?"pop-up pop-up_active":"pop-up",children:Object(p.jsxs)("div",{className:"pop-up__foto-container",children:[Object(p.jsx)("button",{id:"pop-up-foto__btn-close",className:"pop-up__btn-close",type:"button","aria-label":"Close",onClick:n}),Object(p.jsxs)("figure",{className:"pop-up__block-figure",children:[Object(p.jsx)("img",{className:"pop-up__img",src:null===t||void 0===t?void 0:t.link,alt:null===t||void 0===t?void 0:t.name}),Object(p.jsx)("figcaption",{className:"pop-up__text-img",children:null===t||void 0===t?void 0:t.name})]})]})})},x=n(20),v=n(21),N=new(function(){function e(t){var n=t.baseUrl,a=t.headers;Object(x.a)(this,e),this._baseUrl=n,this._headers=a}return Object(v.a)(e,[{key:"getFullInfo",value:function(){return Promise.all([this.getInitialCards(),this.getUserData()])}},{key:"_getResponseData",value:function(e){return e.ok?e.json():Promise.reject("\u041e\u0448\u0438\u0431\u043a\u0430 ".concat(e.status))}},{key:"getInitialCards",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/cards"),{headers:this._headers}).then((function(t){return e._getResponseData(t)}))}},{key:"getUserData",value:function(){var e=this;return fetch("".concat(this._baseUrl,"/users/me"),{headers:this._headers}).then((function(t){return e._getResponseData(t)}))}},{key:"userEdit",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/users/me"),{method:"PATCH",headers:this._headers,body:JSON.stringify({name:e.name,about:e.about})}).then((function(e){return t._getResponseData(e)}))}},{key:"newCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards"),{method:"POST",headers:this._headers,body:JSON.stringify({name:e.name,link:e.link})}).then((function(e){return t._getResponseData(e)}))}},{key:"deleteCard",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._getResponseData(e)}))}},{key:"upgradeAvatar",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/users/me/avatar"),{method:"PATCH",headers:this._headers,body:JSON.stringify({avatar:e})}).then((function(e){return t._getResponseData(e)}))}},{key:"incrementLike",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"PUT",headers:this._headers}).then((function(e){return t._getResponseData(e)}))}},{key:"decrementLike",value:function(e){var t=this;return fetch("".concat(this._baseUrl,"/cards/likes/").concat(e),{method:"DELETE",headers:this._headers}).then((function(e){return t._getResponseData(e)}))}},{key:"changeLikeCardStatus",value:function(e,t){return t?this.decrementLike(e):this.incrementLike(e)}}]),e}())({baseUrl:"https://mesto.nomoreparties.co/v1/cohort-24",headers:{authorization:"af9c4ef2-e2ab-4c32-9f5d-4c36de022449","Content-Type":"application/json"}}),C=function(e){var t=e.isOpen,n=e.onClose,a=e.name,c=e.onSubmit,o=e.textBtn,s=e.children,i=e.title;return Object(p.jsx)("div",{id:a,className:t?"pop-up pop-up_active":"pop-up",children:Object(p.jsxs)("div",{className:"pop-up__container pop-up__container_background",children:[Object(p.jsx)("button",{className:"pop-up__btn-close",type:"button","aria-label":"Close",onClick:n}),Object(p.jsx)("h2",{className:"pop-up__title",children:i}),Object(p.jsxs)("form",{id:a,className:"pop-up__form",action:"#",name:a,onSubmit:c,children:[s,Object(p.jsx)("button",{className:"pop-up__btn-save",type:"submit",children:o})]})]})})},k=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateUser,o=Object(a.useContext)(m),s=Object(a.useState)(""),i=Object(r.a)(s,2),u=i[0],l=i[1],d=Object(a.useState)(""),j=Object(r.a)(d,2),h=j[0],b=j[1];Object(a.useEffect)((function(){l(o.name),b(o.about)}),[o,t]);return Object(p.jsxs)(C,{title:"\u0420\u0435\u0434\u0430\u043a\u0442\u0438\u0440\u043e\u0432\u0430\u0442\u044c \u043f\u0440\u043e\u0444\u0438\u043b\u044c",name:"profile-popup",textBtn:"\u0421\u043e\u0445\u0440\u0430\u043d\u0438\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({name:u,about:h})},children:[Object(p.jsx)("input",{id:"nameInput",type:"text",className:"pop-up__text",value:u||"",onChange:function(e){l(e.target.value)},name:"content-name",placeholder:"\u0412\u0430\u0448\u0435 \u0438\u043c\u044f",minLength:"2",maxLength:"40",required:!0}),Object(p.jsx)("span",{id:"nameInput-error",className:"pop-up__span-error"}),Object(p.jsx)("input",{id:"jobInput",type:"text",className:"pop-up__text",value:h||"",onChange:function(e){b(e.target.value)},name:"content-job",placeholder:"\u041e \u0441\u0435\u0431\u0435",minLength:"2",maxLength:"200",required:!0}),Object(p.jsx)("span",{id:"jobInput-error",className:"pop-up__span-error"})]})},y=function(e){var t=e.isOpen,n=e.onClose,c=e.onUpdateAvatar,o=Object(a.useRef)();return Object(p.jsxs)(C,{title:"\u041e\u0431\u043d\u043e\u0432\u0438\u0442\u044c \u0430\u0432\u0430\u0442\u0430\u0440",name:"pop-up-upgred-avatar",textBtn:"\u0414\u0430",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({avatar:o.current.value})},children:[Object(p.jsx)("input",{id:"linkFotoAvatar",type:"url",className:"pop-up__text",ref:o,name:"contentFotoAvatar",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),Object(p.jsx)("span",{id:"linkFotoAvatar-error",className:"pop-up__span-error"})]})},S=function(e){var t=e.isOpen,n=e.onClose,c=e.onAddPlace,o=Object(a.useState)(""),s=Object(r.a)(o,2),i=s[0],u=s[1],l=Object(a.useState)(""),d=Object(r.a)(l,2),j=d[0],h=d[1];return Object(p.jsxs)(C,{title:"\u041d\u043e\u0432\u043e\u0435 \u043c\u0435\u0441\u0442\u043e",name:"pop-up-supplement-foto",textBtn:"\u0421\u043e\u0437\u0434\u0430\u0442\u044c",isOpen:t,onClose:n,onSubmit:function(e){e.preventDefault(),c({name:i,link:j}),h(""),u("")},children:[Object(p.jsx)("input",{id:"NameFoto",type:"text",className:"pop-up__text",value:i||"",onChange:function(e){u(e.target.value)},name:"content-name-foto",placeholder:"\u041d\u0430\u0437\u0432\u0430\u043d\u0438\u0435",minLength:"2",maxLength:"30",required:!0}),Object(p.jsx)("span",{id:"NameFoto-error",className:"pop-up__span-error"}),Object(p.jsx)("input",{id:"linkFoto",type:"url",className:"pop-up__text",value:j||"",onChange:function(e){h(e.target.value)},name:"content-foto",placeholder:"\u0421\u0441\u044b\u043b\u043a\u0430 \u043d\u0430 \u043a\u0430\u0440\u0442\u0438\u043d\u043a\u0443",required:!0}),Object(p.jsx)("span",{id:"linkFoto-error",className:"pop-up__span-error"})]})},L=function(e){var t=e.registration,n=Object(a.useState)(""),c=Object(r.a)(n,2),o=c[0],s=c[1],i=Object(a.useState)(""),u=Object(r.a)(i,2),l=u[0],j=u[1];return Object(p.jsxs)("section",{className:"authorization",children:[Object(p.jsx)("h2",{className:"authorization__title",children:"\u0420\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u044f"}),Object(p.jsxs)("form",{className:"authorization__form",action:"#",name:"registerName",noValidate:!0,onSubmit:function(e){e.preventDefault(),t(o,l)},children:[Object(p.jsx)("input",{id:"email-Input-Register",type:"text",className:"authorization__dataInput",value:o,onChange:function(e){s(e.target.value)},name:"email-Register",placeholder:"\u0412\u0430\u0448 Email",minLength:"2",maxLength:"40",required:!0}),Object(p.jsx)("input",{id:"password-Input-Register",type:"password",className:"authorization__dataInput",value:l,onChange:function(e){j(e.target.value)},name:"password-Register",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",minLength:"2",maxLength:"200",required:!0}),Object(p.jsx)("button",{className:"authorization__btn",type:"submit",children:"\u0417\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u0442\u044c\u0441\u044f"}),Object(p.jsx)(d.b,{className:"authorization__link",to:"/sign-in",children:"\u0423\u0436\u0435 \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043d\u044b? \u0412\u043e\u0439\u0442\u0438"})]})]})},I=function(e){var t=e.authorization,n=Object(a.useState)(""),c=Object(r.a)(n,2),o=c[0],s=c[1],i=Object(a.useState)(""),u=Object(r.a)(i,2),l=u[0],d=u[1];return Object(p.jsxs)("section",{className:"authorization",children:[Object(p.jsx)("h2",{className:"authorization__title",children:"\u0412\u0445\u043e\u0434"}),Object(p.jsxs)("form",{className:"authorization__form",action:"#",name:"registerName",onSubmit:function(e){e.preventDefault(),t(o,l)},noValidate:!0,children:[Object(p.jsx)("input",{id:"email-Input-Login",type:"text",className:"authorization__dataInput",value:o,onChange:function(e){s(e.target.value)},name:"email-Login",placeholder:"\u0412\u0430\u0448 Email",minLength:"2",maxLength:"40",required:!0}),Object(p.jsx)("input",{id:"password-Input-Login",type:"password",className:"authorization__dataInput",value:l,onChange:function(e){d(e.target.value)},name:"password-Login",placeholder:"\u041f\u0430\u0440\u043e\u043b\u044c",minLength:"2",maxLength:"200",required:!0}),Object(p.jsx)("button",{className:"authorization__btn",type:"submit",children:"\u0412\u043e\u0439\u0442\u0438"})]})]})},P=function(e){var t=e.isOpen,n=e.onClose,a=e.message;return Object(p.jsx)("div",{className:t?"pop-up pop-up_active":"pop-up",children:Object(p.jsxs)("div",{className:"pop-up__container pop-up__container_background pop-up__container_authorization",children:[Object(p.jsx)("button",{className:"pop-up__btn-close",type:"button","aria-label":"Close",onClick:n}),Object(p.jsx)("img",{className:"pop-up__icon",src:a.iconPath,alt:"\u0417\u043d\u0430\u0447\u043e\u043a \u0440\u0435\u0437\u0443\u043b\u044c\u0442\u0430\u0442\u0430 \u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0430\u0446\u0438\u0438"}),Object(p.jsx)("p",{className:"pop-up__icon-text",children:a.text})]})})},D=n(23),U=n(24),E=function(e){var t=e.component,n=Object(U.a)(e,["component"]);return Object(p.jsx)(u.b,{children:function(){return n.loggedIn?Object(p.jsx)(t,Object(D.a)({},n)):Object(p.jsx)(u.a,{to:"/sign-in"})}})},w="https://auth.nomoreparties.co",T=function(e){return e.ok?e.json():Promise.reject("Error ".concat(e.status))},z=function(e){return fetch("".concat(w,"/users/me"),{method:"GET",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)}}).then(T).then((function(e){return e}))},A=n.p+"static/media/UnionTrue.1b6082f8.svg",F=n.p+"static/media/UnionFalse.df8eddf6.svg";var R=function(){var e=Object(a.useState)({}),t=Object(r.a)(e,2),c=t[0],o=t[1],s=Object(a.useState)([]),l=Object(r.a)(s,2),d=l[0],h=l[1],b=Object(a.useState)(!1),f=Object(r.a)(b,2),x=f[0],v=f[1],C=Object(u.g)();Object(a.useEffect)((function(){N.getFullInfo().then((function(e){var t=Object(r.a)(e,2),n=t[0],a=t[1];o(a),h(n)})).catch((function(e){return console.log(e)}))}),[]),Object(a.useEffect)((function(){var e=localStorage.getItem("jwt");e&&z(e).then((function(e){v(!0),ie(e.data.email),C.push("/")})).catch((function(e){return console.log(e)}))}),[C]);var D=Object(a.useState)(!1),U=Object(r.a)(D,2),R=U[0],q=U[1],B=Object(a.useState)(!1),J=Object(r.a)(B,2),V=J[0],H=J[1],M=Object(a.useState)(!1),G=Object(r.a)(M,2),K=G[0],Q=G[1],W=Object(a.useState)(!1),X=Object(r.a)(W,2),Y=X[0],Z=X[1],$=Object(a.useState)({}),ee=Object(r.a)($,2),te=ee[0],ne=ee[1],ae=n(36),ce=Object(a.useState)(""),oe=Object(r.a)(ce,2),se=oe[0],ie=oe[1],re=Object(a.useState)(null),ue=Object(r.a)(re,2),le=ue[0],de=ue[1],pe=function(){Q(!1),q(!1),H(!1),Z(!1),de(null)};function je(e){var t=e.iconPath,n=e.text;ne({iconPath:t,text:n})}var he=function(){Z(!0)};return Object(p.jsxs)(m.Provider,{value:c,children:[Object(p.jsx)(j,{email:se,handleSignOut:function(){v(!1),localStorage.removeItem("jwt"),ie(""),C.push("/sign-in")},loggedIn:x}),Object(p.jsx)(k,{isOpen:R,onClose:pe,onUpdateUser:function(e){N.userEdit(e).then((function(e){o(e),pe()})).catch((function(e){return console.log(e)}))}}),Object(p.jsx)(S,{isOpen:V,onClose:pe,onAddPlace:function(e){N.newCard(e).then((function(e){h([e].concat(Object(i.a)(d))),pe()})).catch((function(e){return console.log(e)}))}}),Object(p.jsx)(y,{isOpen:K,onClose:pe,onUpdateAvatar:function(e){N.upgradeAvatar(e.avatar).then((function(e){o(e),pe()})).catch((function(e){return console.log(e)}))}}),Object(p.jsx)(g,{card:le,onClose:pe}),Object(p.jsx)(P,{isOpen:Y,onClose:pe,message:te}),Object(p.jsxs)(u.d,{children:[Object(p.jsx)(E,{exact:!0,path:"/",loggedIn:x,component:O,cards:d,onCardLike:function(e){var t=e.likes.some((function(e){return e._id===c._id}));N.changeLikeCardStatus(e._id,t).then((function(t){h((function(n){return n.map((function(n){return n._id===e._id?t:n}))}))})).catch((function(e){return console.log(e)}))},onCardDelete:function(e){N.deleteCard(e._id).then((function(t){var n=d.filter((function(t){return t._id!==e._id}));h(n)})).catch((function(e){return console.log(e)}))},onEditAvatar:function(){Q(!0)},onEditProfile:function(){q(!0)},onAddPlace:function(){H(!0)},onCardClick:function(e){de(e)}}),Object(p.jsx)(u.b,{path:"/sign-up",children:Object(p.jsx)(L,{registration:function(e,t){(function(e,t){return fetch("".concat(w,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({password:t,email:e})}).then(T)})(ae(e),t).then((function(e){201===e.status&&(je({iconPath:A,text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0437\u0430\u0440\u0435\u0433\u0438\u0441\u0442\u0440\u0438\u0440\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"}),he(),C.push("/sign-in"),setTimeout(pe,1e3))})).catch((function(e){je({iconPath:F,text:"\u0427\u0442\u043e-\u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a! \u041f\u043e\u043f\u0440\u043e\u0431\u0443\u0439\u0442\u0435 \u0435\u0449\u0451 \u0440\u0430\u0437."}),he(),setTimeout(pe,2500),console.log(e)}))}})}),Object(p.jsx)(u.b,{path:"/sign-in",children:Object(p.jsx)(I,{authorization:function(e,t){(function(e,t){return fetch("".concat(w,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then(T).then((function(e){if(e.token)return localStorage.setItem("jwt",e.token),e.token}))})(ae(e),t).then((function(e){if(!e)throw new Error("\u041f\u0440\u043e\u0438\u0437\u043e\u0448\u043b\u0430 \u043e\u0448\u0438\u0431\u043a\u0430");z(e).then((function(e){ie(e.data.email),v(!0)})).then((function(){je({iconPath:A,text:"\u0412\u044b \u0443\u0441\u043f\u0435\u0448\u043d\u043e \u0430\u0432\u0442\u043e\u0440\u0438\u0437\u043e\u0432\u0430\u043b\u0438\u0441\u044c!"}),he(),C.push("/"),setTimeout(pe,1e3)}))})).catch((function(e){je({iconPath:F,text:"\u0427\u0442\u043e \u0442\u043e \u043f\u043e\u0448\u043b\u043e \u043d\u0435 \u0442\u0430\u043a!"}),he(),console.log(e)}))}})}),Object(p.jsx)(u.b,{exact:!0,path:"/",children:x?Object(p.jsx)(u.a,{to:"/"}):Object(p.jsx)(u.a,{to:"/sign-in"})})]}),Object(p.jsx)(_,{})]})},q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,38)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,o=t.getLCP,s=t.getTTFB;n(e),a(e),c(e),o(e),s(e)}))};s.a.render(Object(p.jsx)(c.a.StrictMode,{children:Object(p.jsx)(d.a,{children:Object(p.jsx)(R,{})})}),document.getElementById("root")),q()}},[[37,1,2]]]);
//# sourceMappingURL=main.c97d0565.chunk.js.map